
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/utils/html-text-parser.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

/****************************************************************************
 Copyright (c) 2013-2016 Chukong Technologies Inc.
 Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.

 https://www.cocos.com/

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated engine source code (the "Software"), a limited,
 worldwide, royalty-free, non-assignable, revocable and non-exclusive license
 to use Cocos Creator solely to develop games on your target platforms. You shall
 not use Cocos Creator software for developing other software or tools that's
 used for developing games. You are not granted to publish, distribute,
 sublicense, and/or sell copies of Cocos Creator.

 The software or tools in this License Agreement are licensed, not sold.
 Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 ****************************************************************************/
var eventRegx = /^(click)(\s)*=|(param)(\s)*=/;
var imageAttrReg = /(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*align(\s)*=|(\s)*offset(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;
/**
 * A utils class for parsing HTML texts. The parsed results will be an object array.
 */

var HtmlTextParser = function HtmlTextParser() {
  this._parsedObject = {};
  this._specialSymbolArray = [];

  this._specialSymbolArray.push([/&lt;/g, '<']);

  this._specialSymbolArray.push([/&gt;/g, '>']);

  this._specialSymbolArray.push([/&amp;/g, '&']);

  this._specialSymbolArray.push([/&quot;/g, '"']);

  this._specialSymbolArray.push([/&apos;/g, '\'']);

  this._specialSymbolArray.push([/&nbsp;/g, ' ']);
};

HtmlTextParser.prototype = {
  constructor: HtmlTextParser,
  parse: function parse(htmlString) {
    this._resultObjectArray = [];
    this._stack = [];
    var startIndex = 0;
    var length = htmlString.length;

    while (startIndex < length) {
      var tagBeginIndex = htmlString.indexOf('<', startIndex);

      if (tagBeginIndex < 0) {
        this._stack.pop();

        this._processResult(htmlString.substring(startIndex));

        startIndex = length;
      } else {
        this._processResult(htmlString.substring(startIndex, tagBeginIndex));

        var tagEndIndex = htmlString.indexOf('>', startIndex);

        if (tagEndIndex === -1) {
          // cc.error('The HTML tag is invalid!');
          tagEndIndex = tagBeginIndex;
        } else if (htmlString.charAt(tagBeginIndex + 1) === '\/') {
          this._stack.pop();
        } else {
          this._addToStack(htmlString.substring(tagBeginIndex + 1, tagEndIndex));
        }

        startIndex = tagEndIndex + 1;
      }
    }

    return this._resultObjectArray;
  },
  _attributeToObject: function _attributeToObject(attribute) {
    attribute = attribute.trim();
    var obj = {};
    var header = attribute.match(/^(color|size)(\s)*=/);
    var tagName;
    var nextSpace;
    var eventObj;
    var eventHanlderString;

    if (header) {
      tagName = header[0];
      attribute = attribute.substring(tagName.length).trim();
      if (attribute === "") return obj; //parse color

      nextSpace = attribute.indexOf(' ');

      switch (tagName[0]) {
        case 'c':
          if (nextSpace > -1) {
            obj.color = attribute.substring(0, nextSpace).trim();
          } else {
            obj.color = attribute;
          }

          break;

        case 's':
          obj.size = parseInt(attribute);
          break;
      } //tag has event arguments


      if (nextSpace > -1) {
        eventHanlderString = attribute.substring(nextSpace + 1).trim();
        eventObj = this._processEventHandler(eventHanlderString);
        obj.event = eventObj;
      }

      return obj;
    }

    header = attribute.match(/^(br(\s)*\/)/);

    if (header && header[0].length > 0) {
      tagName = header[0].trim();

      if (tagName.startsWith("br") && tagName[tagName.length - 1] === "/") {
        obj.isNewLine = true;

        this._resultObjectArray.push({
          text: "",
          style: {
            newline: true
          }
        });

        return obj;
      }
    }

    header = attribute.match(/^(img(\s)*src(\s)*=[^>]+\/)/);

    if (header && header[0].length > 0) {
      tagName = header[0].trim();

      if (tagName.startsWith("img") && tagName[tagName.length - 1] === "/") {
        header = attribute.match(imageAttrReg);
        var tagValue;
        var remainingArgument;
        var isValidImageTag = false;

        while (header) {
          //skip the invalid tags at first
          attribute = attribute.substring(attribute.indexOf(header[0]));
          tagName = attribute.substr(0, header[0].length); //remove space and = character

          remainingArgument = attribute.substring(tagName.length).trim();
          nextSpace = remainingArgument.indexOf(' ');
          tagValue = nextSpace > -1 ? remainingArgument.substr(0, nextSpace) : remainingArgument;
          tagName = tagName.replace(/[^a-zA-Z]/g, "").trim();
          tagName = tagName.toLocaleLowerCase();
          attribute = remainingArgument.substring(nextSpace).trim();

          if (tagName === "src") {
            obj.isImage = true;
            if (tagValue.endsWith('\/')) tagValue = tagValue.substring(0, tagValue.length - 1);

            if (tagValue.indexOf('\'') === 0) {
              isValidImageTag = true;
              tagValue = tagValue.substring(1, tagValue.length - 1);
            } else if (tagValue.indexOf('"') === 0) {
              isValidImageTag = true;
              tagValue = tagValue.substring(1, tagValue.length - 1);
            }

            obj.src = tagValue;
          } else if (tagName === "height") {
            obj.imageHeight = parseInt(tagValue);
          } else if (tagName === "width") {
            obj.imageWidth = parseInt(tagValue);
          } else if (tagName === "align") {
            obj.imageAlign = tagValue.toLocaleLowerCase();
          } else if (tagName === "offset") {
            obj.imageOffset = tagValue;
          } else if (tagName === "click") {
            obj.event = this._processEventHandler(tagName + "=" + tagValue);
          }

          if (obj.event && tagName === 'param') {
            obj.event.param = tagValue.replace(/^\"|\"$/g, '');
          }

          header = attribute.match(imageAttrReg);
        }

        if (isValidImageTag && obj.isImage) {
          this._resultObjectArray.push({
            text: "",
            style: obj
          });
        }

        return {};
      }
    }

    header = attribute.match(/^(outline(\s)*[^>]*)/);

    if (header) {
      attribute = header[0].substring("outline".length).trim();
      var defaultOutlineObject = {
        color: "#ffffff",
        width: 1
      };

      if (attribute) {
        var outlineAttrReg = /(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;
        header = attribute.match(outlineAttrReg);
        var tagValue;

        while (header) {
          //skip the invalid tags at first
          attribute = attribute.substring(attribute.indexOf(header[0]));
          tagName = attribute.substr(0, header[0].length); //remove space and = character

          remainingArgument = attribute.substring(tagName.length).trim();
          nextSpace = remainingArgument.indexOf(' ');

          if (nextSpace > -1) {
            tagValue = remainingArgument.substr(0, nextSpace);
          } else {
            tagValue = remainingArgument;
          }

          tagName = tagName.replace(/[^a-zA-Z]/g, "").trim();
          tagName = tagName.toLocaleLowerCase();
          attribute = remainingArgument.substring(nextSpace).trim();

          if (tagName === "click") {
            obj.event = this._processEventHandler(tagName + "=" + tagValue);
          } else if (tagName === "color") {
            defaultOutlineObject.color = tagValue;
          } else if (tagName === "width") {
            defaultOutlineObject.width = parseInt(tagValue);
          }

          if (obj.event && tagName === 'param') {
            obj.event.param = tagValue.replace(/^\"|\"$/g, '');
          }

          header = attribute.match(outlineAttrReg);
        }
      }

      obj.outline = defaultOutlineObject;
    }

    header = attribute.match(/^(on|u|b|i)(\s)*/);

    if (header && header[0].length > 0) {
      tagName = header[0];
      attribute = attribute.substring(tagName.length).trim();

      switch (tagName[0]) {
        case 'u':
          obj.underline = true;
          break;

        case 'i':
          obj.italic = true;
          break;

        case 'b':
          obj.bold = true;
          break;
      }

      if (attribute === "") {
        return obj;
      }

      eventObj = this._processEventHandler(attribute);
      obj.event = eventObj;
    }

    return obj;
  },
  _processEventHandler: function _processEventHandler(eventString) {
    var index = 0;
    var obj = {};
    var eventNames = eventString.match(eventRegx);
    var isValidTag = false;

    while (eventNames) {
      var eventName = eventNames[0];
      var eventValue = "";
      isValidTag = false;
      eventString = eventString.substring(eventName.length).trim();

      if (eventString.charAt(0) === "\"") {
        index = eventString.indexOf("\"", 1);

        if (index > -1) {
          eventValue = eventString.substring(1, index).trim();
          isValidTag = true;
        }

        index++;
      } else if (eventString.charAt(0) === "\'") {
        index = eventString.indexOf('\'', 1);

        if (index > -1) {
          eventValue = eventString.substring(1, index).trim();
          isValidTag = true;
        }

        index++;
      } else {
        //skip the invalid attribute value
        var match = eventString.match(/(\S)+/);

        if (match) {
          eventValue = match[0];
        } else {
          eventValue = "";
        }

        index = eventValue.length;
      }

      if (isValidTag) {
        eventName = eventName.substring(0, eventName.length - 1).trim();
        obj[eventName] = eventValue;
      }

      eventString = eventString.substring(index).trim();
      eventNames = eventString.match(eventRegx);
    }

    return obj;
  },
  _addToStack: function _addToStack(attribute) {
    var obj = this._attributeToObject(attribute);

    if (this._stack.length === 0) {
      this._stack.push(obj);
    } else {
      if (obj.isNewLine || obj.isImage) {
        return;
      } //for nested tags


      var previousTagObj = this._stack[this._stack.length - 1];

      for (var key in previousTagObj) {
        if (!obj[key]) {
          obj[key] = previousTagObj[key];
        }
      }

      this._stack.push(obj);
    }
  },
  _processResult: function _processResult(value) {
    if (value === "") {
      return;
    }

    value = this._escapeSpecialSymbol(value);

    if (this._stack.length > 0) {
      this._resultObjectArray.push({
        text: value,
        style: this._stack[this._stack.length - 1]
      });
    } else {
      this._resultObjectArray.push({
        text: value
      });
    }
  },
  _escapeSpecialSymbol: function _escapeSpecialSymbol(str) {
    for (var i = 0; i < this._specialSymbolArray.length; ++i) {
      var key = this._specialSymbolArray[i][0];
      var value = this._specialSymbolArray[i][1];
      str = str.replace(key, value);
    }

    return str;
  }
};

if (CC_TEST) {
  cc._Test.HtmlTextParser = HtmlTextParser;
}

module.exports = HtmlTextParser;
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0bWwtdGV4dC1wYXJzZXIuanMiXSwibmFtZXMiOlsiZXZlbnRSZWd4IiwiaW1hZ2VBdHRyUmVnIiwiSHRtbFRleHRQYXJzZXIiLCJfcGFyc2VkT2JqZWN0IiwiX3NwZWNpYWxTeW1ib2xBcnJheSIsInB1c2giLCJwcm90b3R5cGUiLCJjb25zdHJ1Y3RvciIsInBhcnNlIiwiaHRtbFN0cmluZyIsIl9yZXN1bHRPYmplY3RBcnJheSIsIl9zdGFjayIsInN0YXJ0SW5kZXgiLCJsZW5ndGgiLCJ0YWdCZWdpbkluZGV4IiwiaW5kZXhPZiIsInBvcCIsIl9wcm9jZXNzUmVzdWx0Iiwic3Vic3RyaW5nIiwidGFnRW5kSW5kZXgiLCJjaGFyQXQiLCJfYWRkVG9TdGFjayIsIl9hdHRyaWJ1dGVUb09iamVjdCIsImF0dHJpYnV0ZSIsInRyaW0iLCJvYmoiLCJoZWFkZXIiLCJtYXRjaCIsInRhZ05hbWUiLCJuZXh0U3BhY2UiLCJldmVudE9iaiIsImV2ZW50SGFubGRlclN0cmluZyIsImNvbG9yIiwic2l6ZSIsInBhcnNlSW50IiwiX3Byb2Nlc3NFdmVudEhhbmRsZXIiLCJldmVudCIsInN0YXJ0c1dpdGgiLCJpc05ld0xpbmUiLCJ0ZXh0Iiwic3R5bGUiLCJuZXdsaW5lIiwidGFnVmFsdWUiLCJyZW1haW5pbmdBcmd1bWVudCIsImlzVmFsaWRJbWFnZVRhZyIsInN1YnN0ciIsInJlcGxhY2UiLCJ0b0xvY2FsZUxvd2VyQ2FzZSIsImlzSW1hZ2UiLCJlbmRzV2l0aCIsInNyYyIsImltYWdlSGVpZ2h0IiwiaW1hZ2VXaWR0aCIsImltYWdlQWxpZ24iLCJpbWFnZU9mZnNldCIsInBhcmFtIiwiZGVmYXVsdE91dGxpbmVPYmplY3QiLCJ3aWR0aCIsIm91dGxpbmVBdHRyUmVnIiwib3V0bGluZSIsInVuZGVybGluZSIsIml0YWxpYyIsImJvbGQiLCJldmVudFN0cmluZyIsImluZGV4IiwiZXZlbnROYW1lcyIsImlzVmFsaWRUYWciLCJldmVudE5hbWUiLCJldmVudFZhbHVlIiwicHJldmlvdXNUYWdPYmoiLCJrZXkiLCJ2YWx1ZSIsIl9lc2NhcGVTcGVjaWFsU3ltYm9sIiwic3RyIiwiaSIsIkNDX1RFU1QiLCJjYyIsIl9UZXN0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBMEJBLElBQUlBLFNBQVMsR0FBRyw4QkFBaEI7QUFDQSxJQUFJQyxZQUFZLEdBQUcsd0hBQW5CO0FBQ0E7Ozs7QUFHQSxJQUFJQyxjQUFjLEdBQUcsU0FBakJBLGNBQWlCLEdBQVc7QUFDNUIsT0FBS0MsYUFBTCxHQUFxQixFQUFyQjtBQUNBLE9BQUtDLG1CQUFMLEdBQTJCLEVBQTNCOztBQUNBLE9BQUtBLG1CQUFMLENBQXlCQyxJQUF6QixDQUE4QixDQUFDLE9BQUQsRUFBVSxHQUFWLENBQTlCOztBQUNBLE9BQUtELG1CQUFMLENBQXlCQyxJQUF6QixDQUE4QixDQUFDLE9BQUQsRUFBVSxHQUFWLENBQTlCOztBQUNBLE9BQUtELG1CQUFMLENBQXlCQyxJQUF6QixDQUE4QixDQUFDLFFBQUQsRUFBVyxHQUFYLENBQTlCOztBQUNBLE9BQUtELG1CQUFMLENBQXlCQyxJQUF6QixDQUE4QixDQUFDLFNBQUQsRUFBWSxHQUFaLENBQTlCOztBQUNBLE9BQUtELG1CQUFMLENBQXlCQyxJQUF6QixDQUE4QixDQUFDLFNBQUQsRUFBWSxJQUFaLENBQTlCOztBQUNBLE9BQUtELG1CQUFMLENBQXlCQyxJQUF6QixDQUE4QixDQUFDLFNBQUQsRUFBWSxHQUFaLENBQTlCO0FBQ0gsQ0FURDs7QUFXQUgsY0FBYyxDQUFDSSxTQUFmLEdBQTJCO0FBQ3ZCQyxFQUFBQSxXQUFXLEVBQUVMLGNBRFU7QUFFdkJNLEVBQUFBLEtBQUssRUFBRSxlQUFTQyxVQUFULEVBQXFCO0FBQ3hCLFNBQUtDLGtCQUFMLEdBQTBCLEVBQTFCO0FBQ0EsU0FBS0MsTUFBTCxHQUFjLEVBQWQ7QUFFQSxRQUFJQyxVQUFVLEdBQUcsQ0FBakI7QUFDQSxR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QixRQUFBQSxLQUFLLEVBQUUsS0FBSzdCLE1BQUwsQ0FBWSxLQUFLQSxNQUFMLENBQVlFLE1BQVosR0FBcUIsQ0FBakM7QUFBckIsT0FBN0I7QUFDSCxLQUZELE1BRU87QUFDSCxXQUFLSCxrQkFBTCxDQUF3QkwsSUFBeEIsQ0FBNkI7QUFBQ2tDLFFBQUFBLElBQUksRUFBRWdDO0FBQVAsT0FBN0I7QUFDSDtBQUNKLEdBaFNzQjtBQWtTdkJDLEVBQUFBLG9CQUFvQixFQUFFLDhCQUFTQyxHQUFULEVBQWM7QUFDaEMsU0FBSSxJQUFJQyxDQUFDLEdBQUcsQ0FBWixFQUFlQSxDQUFDLEdBQUcsS0FBS3RFLG1CQUFMLENBQXlCUyxNQUE1QyxFQUFvRCxFQUFFNkQsQ0FBdEQsRUFBeUQ7QUFDckQsVUFBSUosR0FBRyxHQUFHLEtBQUtsRSxtQkFBTCxDQUF5QnNFLENBQXpCLEVBQTRCLENBQTVCLENBQVY7QUFDQSxVQUFJSCxLQUFLLEdBQUcsS0FBS25FLG1CQUFMLENBQXlCc0UsQ0FBekIsRUFBNEIsQ0FBNUIsQ0FBWjtBQUVBRCxNQUFBQSxHQUFHLEdBQUdBLEdBQUcsQ0FBQzNCLE9BQUosQ0FBWXdCLEdBQVosRUFBaUJDLEtBQWpCLENBQU47QUFDSDs7QUFDRCxXQUFPRSxHQUFQO0FBQ0g7QUExU3NCLENBQTNCOztBQTZTQSxJQUFJRSxPQUFKLEVBQWE7QUFDVEMsRUFBQUEsRUFBRSxDQUFDQyxLQUFILENBQVMzRSxjQUFULEdBQTBCQSxjQUExQjtBQUNIOztBQUVENEUsTUFBTSxDQUFDQyxPQUFQLEdBQWlCN0UsY0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIENvcHlyaWdodCAoYykgMjAxMy0yMDE2IENodWtvbmcgVGVjaG5vbG9naWVzIEluYy5cbiBDb3B5cmlnaHQgKGMpIDIwMTctMjAxOCBYaWFtZW4gWWFqaSBTb2Z0d2FyZSBDby4sIEx0ZC5cblxuIGh0dHBzOi8vd3d3LmNvY29zLmNvbS9cblxuIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGVuZ2luZSBzb3VyY2UgY29kZSAodGhlIFwiU29mdHdhcmVcIiksIGEgbGltaXRlZCxcbiB3b3JsZHdpZGUsIHJveWFsdHktZnJlZSwgbm9uLWFzc2lnbmFibGUsIHJldm9jYWJsZSBhbmQgbm9uLWV4Y2x1c2l2ZSBsaWNlbnNlXG4gdG8gdXNlIENvY29zIENyZWF0b3Igc29sZWx5IHRvIGRldmVsb3AgZ2FtZXMgb24geW91ciB0YXJnZXQgcGxhdGZvcm1zLiBZb3Ugc2hhbGxcbiBub3QgdXNlIENvY29zIENyZWF0b3Igc29mdHdhcmUgZm9yIGRldmVsb3Bpbmcgb3RoZXIgc29mdHdhcmUgb3IgdG9vbHMgdGhhdCdzXG4gdXNlZCBmb3IgZGV2ZWxvcGluZyBnYW1lcy4gWW91IGFyZSBub3QgZ3JhbnRlZCB0byBwdWJsaXNoLCBkaXN0cmlidXRlLFxuIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiBDb2NvcyBDcmVhdG9yLlxuXG4gVGhlIHNvZnR3YXJlIG9yIHRvb2xzIGluIHRoaXMgTGljZW5zZSBBZ3JlZW1lbnQgYXJlIGxpY2Vuc2VkLCBub3Qgc29sZC5cbiBYaWFtZW4gWWFqaSBTb2Z0d2FyZSBDby4sIEx0ZC4gcmVzZXJ2ZXMgYWxsIHJpZ2h0cyBub3QgZXhwcmVzc2x5IGdyYW50ZWQgdG8geW91LlxuXG4gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiBUSEUgU09GVFdBUkUuXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxudmFyIGV2ZW50UmVneCA9IC9eKGNsaWNrKShcXHMpKj18KHBhcmFtKShcXHMpKj0vO1xudmFyIGltYWdlQXR0clJlZyA9IC8oXFxzKSpzcmMoXFxzKSo9fChcXHMpKmhlaWdodChcXHMpKj18KFxccykqd2lkdGgoXFxzKSo9fChcXHMpKmFsaWduKFxccykqPXwoXFxzKSpvZmZzZXQoXFxzKSo9fChcXHMpKmNsaWNrKFxccykqPXwoXFxzKSpwYXJhbShcXHMpKj0vO1xuLyoqXG4gKiBBIHV0aWxzIGNsYXNzIGZvciBwYXJzaW5nIEhUTUwgdGV4dHMuIFRoZSBwYXJzZWQgcmVzdWx0cyB3aWxsIGJlIGFuIG9iamVjdCBhcnJheS5cbiAqL1xudmFyIEh0bWxUZXh0UGFyc2VyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fcGFyc2VkT2JqZWN0ID0ge307XG4gICAgdGhpcy5fc3BlY2lhbFN5bWJvbEFycmF5ID0gW107XG4gICAgdGhpcy5fc3BlY2lhbFN5bWJvbEFycmF5LnB1c2goWy8mbHQ7L2csICc8J10pO1xuICAgIHRoaXMuX3NwZWNpYWxTeW1ib2xBcnJheS5wdXNoKFsvJmd0Oy9nLCAnPiddKTtcbiAgICB0aGlzLl9zcGVjaWFsU3ltYm9sQXJyYXkucHVzaChbLyZhbXA7L2csICcmJ10pO1xuICAgIHRoaXMuX3NwZWNpYWxTeW1ib2xBcnJheS5wdXNoKFsvJnF1b3Q7L2csICdcIiddKTtcbiAgICB0aGlzLl9zcGVjaWFsU3ltYm9sQXJyYXkucHVzaChbLyZhcG9zOy9nLCAnXFwnJ10pO1xuICAgIHRoaXMuX3NwZWNpYWxTeW1ib2xBcnJheS5wdXNoKFsvJm5ic3A7L2csICcgJ10pO1xufTtcblxuSHRtbFRleHRQYXJzZXIucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBIdG1sVGV4dFBhcnNlcixcbiAgICBwYXJzZTogZnVuY3Rpb24oaHRtbFN0cmluZykge1xuICAgICAgICB0aGlzLl9yZXN1bHRPYmplY3RBcnJheSA9IFtdO1xuICAgICAgICB0aGlzLl9zdGFjayA9IFtdO1xuXG4gICAgICAgIHZhciBzdGFydEluZGV4ID0gMDtcbiAgICAgICAgdmFyIGxlbmd0aCA9IGh0bWxTdHJpbmcubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoc3RhcnRJbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIHRhZ0JlZ2luSW5kZXggPSBodG1sU3RyaW5nLmluZGV4T2YoJzwnLCBzdGFydEluZGV4KTtcbiAgICAgICAgICAgIGlmICh0YWdCZWdpbkluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YWNrLnBvcCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NSZXN1bHQoaHRtbFN0cmluZy5zdWJzdHJpbmcoc3RhcnRJbmRleCkpO1xuICAgICAgICAgICAgICAgIHN0YXJ0SW5kZXggPSBsZW5ndGg7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NSZXN1bHQoaHRtbFN0cmluZy5zdWJzdHJpbmcoc3RhcnRJbmRleCwgdGFnQmVnaW5JbmRleCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRhZ0VuZEluZGV4ID0gaHRtbFN0cmluZy5pbmRleE9mKCc+Jywgc3RhcnRJbmRleCk7XG4gICAgICAgICAgICAgICAgaWYgKHRhZ0VuZEluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjYy5lcnJvcignVGhlIEhUTUwgdGFnIGlzIGludmFsaWQhJyk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0VuZEluZGV4ID0gdGFnQmVnaW5JbmRleDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGh0bWxTdHJpbmcuY2hhckF0KHRhZ0JlZ2luSW5kZXggKyAxKSA9PT0gJ1xcLycpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRUb1N0YWNrKGh0bWxTdHJpbmcuc3Vic3RyaW5nKHRhZ0JlZ2luSW5kZXggKyAxLCB0YWdFbmRJbmRleCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGFydEluZGV4ID0gdGFnRW5kSW5kZXggKyAxO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIHJldHVybiB0aGlzLl9yZXN1bHRPYmplY3RBcnJheTtcbiAgICB9LFxuXG4gICAgX2F0dHJpYnV0ZVRvT2JqZWN0OiBmdW5jdGlvbiAoYXR0cmlidXRlKSB7XG4gICAgICAgIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZS50cmltKCk7XG5cbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICB2YXIgaGVhZGVyID0gYXR0cmlidXRlLm1hdGNoKC9eKGNvbG9yfHNpemUpKFxccykqPS8pO1xuICAgICAgICB2YXIgdGFnTmFtZTtcbiAgICAgICAgdmFyIG5leHRTcGFjZTtcbiAgICAgICAgdmFyIGV2ZW50T2JqO1xuICAgICAgICB2YXIgZXZlbnRIYW5sZGVyU3RyaW5nO1xuICAgICAgICBpZiAoaGVhZGVyKSB7XG4gICAgICAgICAgICB0YWdOYW1lID0gaGVhZGVyWzBdO1xuICAgICAgICAgICAgYXR0cmlidXRlID0gYXR0cmlidXRlLnN1YnN0cmluZyh0YWdOYW1lLmxlbmd0aCkudHJpbSgpO1xuICAgICAgICAgICAgaWYoYXR0cmlidXRlID09PSBcIlwiKSByZXR1cm4gb2JqO1xuXG4gICAgICAgICAgICAvL3BhcnNlIGNvbG9yXG4gICAgICAgICAgICBuZXh0U3BhY2UgPSBhdHRyaWJ1dGUuaW5kZXhPZignICcpO1xuICAgICAgICAgICAgc3dpdGNoKHRhZ05hbWVbMF0pe1xuICAgICAgICAgICAgICBjYXNlICdjJzpcbiAgICAgICAgICAgICAgICAgIGlmIChuZXh0U3BhY2UgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgIG9iai5jb2xvciA9IGF0dHJpYnV0ZS5zdWJzdHJpbmcoMCwgbmV4dFNwYWNlKS50cmltKCk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIG9iai5jb2xvciA9IGF0dHJpYnV0ZTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlICdzJzpcbiAgICAgICAgICAgICAgICAgIG9iai5zaXplID0gcGFyc2VJbnQoYXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3RhZyBoYXMgZXZlbnQgYXJndW1lbnRzXG4gICAgICAgICAgICBpZihuZXh0U3BhY2UgPiAtMSkge1xuICAgICAgICAgICAgICAgIGV2ZW50SGFubGRlclN0cmluZyA9IGF0dHJpYnV0ZS5zdWJzdHJpbmcobmV4dFNwYWNlKzEpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBldmVudE9iaiA9IHRoaXMuX3Byb2Nlc3NFdmVudEhhbmRsZXIoZXZlbnRIYW5sZGVyU3RyaW5nKTtcbiAgICAgICAgICAgICAgICBvYmouZXZlbnQgPSBldmVudE9iajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH1cblxuICAgICAgICBoZWFkZXIgPSBhdHRyaWJ1dGUubWF0Y2goL14oYnIoXFxzKSpcXC8pLyk7XG4gICAgICAgIGlmKGhlYWRlciAmJiBoZWFkZXJbMF0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGFnTmFtZSA9IGhlYWRlclswXS50cmltKCk7XG4gICAgICAgICAgICBpZih0YWdOYW1lLnN0YXJ0c1dpdGgoXCJiclwiKSAmJiB0YWdOYW1lW3RhZ05hbWUubGVuZ3RoLTFdID09PSBcIi9cIikge1xuICAgICAgICAgICAgICAgIG9iai5pc05ld0xpbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3VsdE9iamVjdEFycmF5LnB1c2goe3RleHQ6IFwiXCIsIHN0eWxlOiB7bmV3bGluZTogdHJ1ZX19KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaGVhZGVyID0gYXR0cmlidXRlLm1hdGNoKC9eKGltZyhcXHMpKnNyYyhcXHMpKj1bXj5dK1xcLykvKTtcbiAgICAgICAgaWYoaGVhZGVyICYmIGhlYWRlclswXS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YWdOYW1lID0gaGVhZGVyWzBdLnRyaW0oKTtcbiAgICAgICAgICAgIGlmKHRhZ05hbWUuc3RhcnRzV2l0aChcImltZ1wiKSAmJiB0YWdOYW1lW3RhZ05hbWUubGVuZ3RoLTFdID09PSBcIi9cIikge1xuICAgICAgICAgICAgICAgIGhlYWRlciA9IGF0dHJpYnV0ZS5tYXRjaChpbWFnZUF0dHJSZWcpO1xuICAgICAgICAgICAgICAgIHZhciB0YWdWYWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgcmVtYWluaW5nQXJndW1lbnQ7XG4gICAgICAgICAgICAgICAgdmFyIGlzVmFsaWRJbWFnZVRhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHdoaWxlIChoZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9za2lwIHRoZSBpbnZhbGlkIHRhZ3MgYXQgZmlyc3RcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlID0gYXR0cmlidXRlLnN1YnN0cmluZyhhdHRyaWJ1dGUuaW5kZXhPZihoZWFkZXJbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgdGFnTmFtZSA9IGF0dHJpYnV0ZS5zdWJzdHIoMCwgaGVhZGVyWzBdLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIHNwYWNlIGFuZCA9IGNoYXJhY3RlclxuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdBcmd1bWVudCA9IGF0dHJpYnV0ZS5zdWJzdHJpbmcodGFnTmFtZS5sZW5ndGgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dFNwYWNlID0gcmVtYWluaW5nQXJndW1lbnQuaW5kZXhPZignICcpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRhZ1ZhbHVlID0gKG5leHRTcGFjZSA+IC0xKSA/IHJlbWFpbmluZ0FyZ3VtZW50LnN1YnN0cigwLCBuZXh0U3BhY2UpIDogcmVtYWluaW5nQXJndW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIHRhZ05hbWUgPSB0YWdOYW1lLnJlcGxhY2UoL1teYS16QS1aXS9nLCBcIlwiKS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ05hbWUgPSB0YWdOYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlID0gcmVtYWluaW5nQXJndW1lbnQuc3Vic3RyaW5nKG5leHRTcGFjZSkudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFnTmFtZSA9PT0gXCJzcmNcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmlzSW1hZ2UgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggdGFnVmFsdWUuZW5kc1dpdGgoICdcXC8nICkgKSB0YWdWYWx1ZSA9IHRhZ1ZhbHVlLnN1YnN0cmluZyggMCwgdGFnVmFsdWUubGVuZ3RoIC0gMSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHRhZ1ZhbHVlLmluZGV4T2YoJ1xcJycpPT09MCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1ZhbGlkSW1hZ2VUYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ1ZhbHVlID0gdGFnVmFsdWUuc3Vic3RyaW5nKCAxLCB0YWdWYWx1ZS5sZW5ndGggLSAxICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoIHRhZ1ZhbHVlLmluZGV4T2YoJ1wiJyk9PT0wICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzVmFsaWRJbWFnZVRhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnVmFsdWUgPSB0YWdWYWx1ZS5zdWJzdHJpbmcoIDEsIHRhZ1ZhbHVlLmxlbmd0aCAtIDEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5zcmMgPSB0YWdWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YWdOYW1lID09PSBcImhlaWdodFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouaW1hZ2VIZWlnaHQgPSBwYXJzZUludCh0YWdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFnTmFtZSA9PT0gXCJ3aWR0aFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouaW1hZ2VXaWR0aCA9IHBhcnNlSW50KHRhZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YWdOYW1lID09PSBcImFsaWduXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5pbWFnZUFsaWduID0gdGFnVmFsdWUudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YWdOYW1lID09PSBcIm9mZnNldFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouaW1hZ2VPZmZzZXQgPSB0YWdWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YWdOYW1lID09PSBcImNsaWNrXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5ldmVudCA9IHRoaXMuX3Byb2Nlc3NFdmVudEhhbmRsZXIodGFnTmFtZSArIFwiPVwiICsgdGFnVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5ldmVudCAmJiB0YWdOYW1lID09PSAncGFyYW0nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouZXZlbnQucGFyYW0gPSB0YWdWYWx1ZS5yZXBsYWNlKC9eXFxcInxcXFwiJC9nLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBhdHRyaWJ1dGUubWF0Y2goaW1hZ2VBdHRyUmVnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiggaXNWYWxpZEltYWdlVGFnICYmIG9iai5pc0ltYWdlIClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3VsdE9iamVjdEFycmF5LnB1c2goe3RleHQ6IFwiXCIsIHN0eWxlOiBvYmp9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBoZWFkZXIgPSBhdHRyaWJ1dGUubWF0Y2goL14ob3V0bGluZShcXHMpKltePl0qKS8pO1xuICAgICAgICBpZiAoaGVhZGVyKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGUgPSBoZWFkZXJbMF0uc3Vic3RyaW5nKFwib3V0bGluZVwiLmxlbmd0aCkudHJpbSgpO1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRPdXRsaW5lT2JqZWN0ID0ge2NvbG9yOiBcIiNmZmZmZmZcIiwgd2lkdGg6IDF9O1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgIHZhciBvdXRsaW5lQXR0clJlZyA9IC8oXFxzKSpjb2xvcihcXHMpKj18KFxccykqd2lkdGgoXFxzKSo9fChcXHMpKmNsaWNrKFxccykqPXwoXFxzKSpwYXJhbShcXHMpKj0vO1xuICAgICAgICAgICAgICAgIGhlYWRlciA9IGF0dHJpYnV0ZS5tYXRjaChvdXRsaW5lQXR0clJlZyk7XG4gICAgICAgICAgICAgICAgdmFyIHRhZ1ZhbHVlO1xuICAgICAgICAgICAgICAgIHdoaWxlIChoZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9za2lwIHRoZSBpbnZhbGlkIHRhZ3MgYXQgZmlyc3RcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlID0gYXR0cmlidXRlLnN1YnN0cmluZyhhdHRyaWJ1dGUuaW5kZXhPZihoZWFkZXJbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgdGFnTmFtZSA9IGF0dHJpYnV0ZS5zdWJzdHIoMCwgaGVhZGVyWzBdLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIC8vcmVtb3ZlIHNwYWNlIGFuZCA9IGNoYXJhY3RlclxuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdBcmd1bWVudCA9IGF0dHJpYnV0ZS5zdWJzdHJpbmcodGFnTmFtZS5sZW5ndGgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dFNwYWNlID0gcmVtYWluaW5nQXJndW1lbnQuaW5kZXhPZignICcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dFNwYWNlID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ1ZhbHVlID0gcmVtYWluaW5nQXJndW1lbnQuc3Vic3RyKDAsIG5leHRTcGFjZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWdWYWx1ZSA9IHJlbWFpbmluZ0FyZ3VtZW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRhZ05hbWUgPSB0YWdOYW1lLnJlcGxhY2UoL1teYS16QS1aXS9nLCBcIlwiKS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ05hbWUgPSB0YWdOYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlID0gcmVtYWluaW5nQXJndW1lbnQuc3Vic3RyaW5nKG5leHRTcGFjZSkudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFnTmFtZSA9PT0gXCJjbGlja1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouZXZlbnQgPSB0aGlzLl9wcm9jZXNzRXZlbnRIYW5kbGVyKHRhZ05hbWUgKyBcIj1cIiArIHRhZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YWdOYW1lID09PSBcImNvbG9yXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRPdXRsaW5lT2JqZWN0LmNvbG9yID0gdGFnVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFnTmFtZSA9PT0gXCJ3aWR0aFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0T3V0bGluZU9iamVjdC53aWR0aCA9IHBhcnNlSW50KHRhZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouZXZlbnQgJiYgdGFnTmFtZSA9PT0gJ3BhcmFtJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmV2ZW50LnBhcmFtID0gdGFnVmFsdWUucmVwbGFjZSgvXlxcXCJ8XFxcIiQvZywgJycpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyID0gYXR0cmlidXRlLm1hdGNoKG91dGxpbmVBdHRyUmVnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvYmoub3V0bGluZSA9IGRlZmF1bHRPdXRsaW5lT2JqZWN0O1xuICAgICAgICB9XG5cbiAgICAgICAgaGVhZGVyID0gYXR0cmlidXRlLm1hdGNoKC9eKG9ufHV8YnxpKShcXHMpKi8pO1xuICAgICAgICBpZihoZWFkZXIgJiYgaGVhZGVyWzBdLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRhZ05hbWUgPSBoZWFkZXJbMF07XG4gICAgICAgICAgICBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGUuc3Vic3RyaW5nKHRhZ05hbWUubGVuZ3RoKS50cmltKCk7XG4gICAgICAgICAgICBzd2l0Y2godGFnTmFtZVswXSl7XG4gICAgICAgICAgICAgIGNhc2UgJ3UnOlxuICAgICAgICAgICAgICAgICAgb2JqLnVuZGVybGluZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSAnaSc6XG4gICAgICAgICAgICAgICAgICBvYmouaXRhbGljID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlICdiJzpcbiAgICAgICAgICAgICAgICAgIG9iai5ib2xkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoYXR0cmlidXRlID09PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV2ZW50T2JqID0gdGhpcy5fcHJvY2Vzc0V2ZW50SGFuZGxlcihhdHRyaWJ1dGUpO1xuICAgICAgICAgICAgb2JqLmV2ZW50ID0gZXZlbnRPYmo7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH0sXG5cbiAgICBfcHJvY2Vzc0V2ZW50SGFuZGxlcjogZnVuY3Rpb24gKGV2ZW50U3RyaW5nKSB7XG4gICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgIHZhciBvYmogPSB7fTtcbiAgICAgICAgdmFyIGV2ZW50TmFtZXMgPSBldmVudFN0cmluZy5tYXRjaChldmVudFJlZ3gpO1xuICAgICAgICB2YXIgaXNWYWxpZFRhZyA9IGZhbHNlO1xuICAgICAgICB3aGlsZShldmVudE5hbWVzKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnROYW1lID0gZXZlbnROYW1lc1swXTtcbiAgICAgICAgICAgIHZhciBldmVudFZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgIGlzVmFsaWRUYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGV2ZW50U3RyaW5nID0gZXZlbnRTdHJpbmcuc3Vic3RyaW5nKGV2ZW50TmFtZS5sZW5ndGgpLnRyaW0oKTtcbiAgICAgICAgICAgIGlmKGV2ZW50U3RyaW5nLmNoYXJBdCgwKSA9PT0gXCJcXFwiXCIpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IGV2ZW50U3RyaW5nLmluZGV4T2YoXCJcXFwiXCIsIDEpO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50VmFsdWUgPSBldmVudFN0cmluZy5zdWJzdHJpbmcoMSwgaW5kZXgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgaXNWYWxpZFRhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICB9IGVsc2UgaWYoZXZlbnRTdHJpbmcuY2hhckF0KDApID09PSBcIlxcJ1wiKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSBldmVudFN0cmluZy5pbmRleE9mKCdcXCcnLCAxKTtcbiAgICAgICAgICAgICAgICBpZihpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50VmFsdWUgPSBldmVudFN0cmluZy5zdWJzdHJpbmcoMSwgaW5kZXgpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgaXNWYWxpZFRhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vc2tpcCB0aGUgaW52YWxpZCBhdHRyaWJ1dGUgdmFsdWVcbiAgICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSBldmVudFN0cmluZy5tYXRjaCgvKFxcUykrLyk7XG4gICAgICAgICAgICAgICAgaWYobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRWYWx1ZSA9IG1hdGNoWzBdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50VmFsdWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpbmRleCA9IGV2ZW50VmFsdWUubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZihpc1ZhbGlkVGFnKSB7XG4gICAgICAgICAgICAgICAgZXZlbnROYW1lID0gZXZlbnROYW1lLnN1YnN0cmluZygwLCBldmVudE5hbWUubGVuZ3RoLTEpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBvYmpbZXZlbnROYW1lXSA9IGV2ZW50VmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV2ZW50U3RyaW5nID0gZXZlbnRTdHJpbmcuc3Vic3RyaW5nKGluZGV4KS50cmltKCk7XG4gICAgICAgICAgICBldmVudE5hbWVzID0gZXZlbnRTdHJpbmcubWF0Y2goZXZlbnRSZWd4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfSxcblxuICAgIF9hZGRUb1N0YWNrOiBmdW5jdGlvbihhdHRyaWJ1dGUpIHtcbiAgICAgICAgdmFyIG9iaiA9IHRoaXMuX2F0dHJpYnV0ZVRvT2JqZWN0KGF0dHJpYnV0ZSk7XG5cbiAgICAgICAgaWYgKHRoaXMuX3N0YWNrLmxlbmd0aCA9PT0gMCl7XG4gICAgICAgICAgICB0aGlzLl9zdGFjay5wdXNoKG9iaik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZihvYmouaXNOZXdMaW5lIHx8IG9iai5pc0ltYWdlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9mb3IgbmVzdGVkIHRhZ3NcbiAgICAgICAgICAgIHZhciBwcmV2aW91c1RhZ09iaiA9IHRoaXMuX3N0YWNrW3RoaXMuX3N0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHByZXZpb3VzVGFnT2JqKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEob2JqW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ialtrZXldID0gcHJldmlvdXNUYWdPYmpba2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zdGFjay5wdXNoKG9iaik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX3Byb2Nlc3NSZXN1bHQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gXCJcIikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFsdWUgPSB0aGlzLl9lc2NhcGVTcGVjaWFsU3ltYm9sKHZhbHVlKTtcbiAgICAgICAgaWYgKHRoaXMuX3N0YWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc3VsdE9iamVjdEFycmF5LnB1c2goe3RleHQ6IHZhbHVlLCBzdHlsZTogdGhpcy5fc3RhY2tbdGhpcy5fc3RhY2subGVuZ3RoIC0gMV19KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc3VsdE9iamVjdEFycmF5LnB1c2goe3RleHQ6IHZhbHVlfSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX2VzY2FwZVNwZWNpYWxTeW1ib2w6IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5fc3BlY2lhbFN5bWJvbEFycmF5Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5fc3BlY2lhbFN5bWJvbEFycmF5W2ldWzBdO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5fc3BlY2lhbFN5bWJvbEFycmF5W2ldWzFdO1xuXG4gICAgICAgICAgICBzdHIgPSBzdHIucmVwbGFjZShrZXksIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH1cbn07XG5cbmlmIChDQ19URVNUKSB7XG4gICAgY2MuX1Rlc3QuSHRtbFRleHRQYXJzZXIgPSBIdG1sVGV4dFBhcnNlcjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBIdG1sVGV4dFBhcnNlcjsiXX0=