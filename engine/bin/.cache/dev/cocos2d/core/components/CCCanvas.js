
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/components/CCCanvas.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

/****************************************************************************
 Copyright (c) 2013-2016 Chukong Technologies Inc.
 Copyright (c) 2017-2018 Xiamen Yaji Software Co., Ltd.

 https://www.cocos.com/

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated engine source code (the "Software"), a limited,
  worldwide, royalty-free, non-assignable, revocable and non-exclusive license
 to use Cocos Creator solely to develop games on your target platforms. You shall
  not use Cocos Creator software for developing other software or tools that's
  used for developing games. You are not granted to publish, distribute,
  sublicense, and/or sell copies of Cocos Creator.

 The software or tools in this License Agreement are licensed, not sold.
 Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 ****************************************************************************/
var Camera = require('../camera/CCCamera');

var Component = require('./CCComponent'); // Screen adaptation strategy for Canvas + Widget


function addWidgetComponent(canvas) {
  var widget = canvas.node.getComponent(cc.Widget);

  if (!widget) {
    widget = canvas.node.addComponent(cc.Widget);
  }

  widget.isAlignTop = true;
  widget.isAlignBottom = true;
  widget.isAlignLeft = true;
  widget.isAlignRight = true;
}
/**
 * !#zh: 作为 UI 根节点，为所有子节点提供视窗四边的位置信息以供对齐，另外提供屏幕适配策略接口，方便从编辑器设置。
 * 注：由于本节点的尺寸会跟随屏幕拉伸，所以 anchorPoint 只支持 (0.5, 0.5)，否则适配不同屏幕时坐标会有偏差。
 *
 * @class Canvas
 * @extends Component
 */


var Canvas = cc.Class({
  name: 'cc.Canvas',
  "extends": Component,
  editor: CC_EDITOR && {
    menu: 'i18n:MAIN_MENU.component.ui/Canvas',
    help: 'i18n:COMPONENT.help_url.canvas',
    executeInEditMode: true,
    disallowMultiple: true
  },
  resetInEditor: CC_EDITOR && function () {
    _Scene._applyCanvasPreferences(this);

    addWidgetComponent(this);
  },
  statics: {
    /**
     * !#en Current active canvas, the scene should only have one active canvas at the same time.
     * !#zh 当前激活的画布组件，场景同一时间只能有一个激活的画布。
     * @property {Canvas} instance
     * @static
     */
    instance: null
  },
  properties: {
    /**
     * !#en The desigin resolution for current scene.
     * !#zh 当前场景设计分辨率。
     * @property {Size} designResolution
     * @default new cc.Size(960, 640)
     */
    _designResolution: cc.size(960, 640),
    designResolution: {
      get: function get() {
        return cc.size(this._designResolution);
      },
      set: function set(value) {
        this._designResolution.width = value.width;
        this._designResolution.height = value.height;
        this.applySettings();
        CC_EDITOR && this._fitDesignResolution();
      },
      tooltip: CC_DEV && 'i18n:COMPONENT.canvas.design_resolution'
    },
    _fitWidth: false,
    _fitHeight: true,

    /**
     * !#en TODO
     * !#zh: 是否优先将设计分辨率高度撑满视图高度。
     * @property {Boolean} fitHeight
     * @default false
     */
    fitHeight: {
      get: function get() {
        return this._fitHeight;
      },
      set: function set(value) {
        if (this._fitHeight !== value) {
          this._fitHeight = value;
          this.applySettings();
        }
      },
      tooltip: CC_DEV && 'i18n:COMPONENT.canvas.fit_height'
    },

    /**
     * !#en TODO
     * !#zh: 是否优先将设计分辨率宽度撑满视图宽度。
     * @property {Boolean} fitWidth
     * @default false
     */
    fitWidth: {
      get: function get() {
        return this._fitWidth;
      },
      set: function set(value) {
        if (this._fitWidth !== value) {
          this._fitWidth = value;
          this.applySettings();
        }
      },
      tooltip: CC_DEV && 'i18n:COMPONENT.canvas.fit_width'
    }
  },
  _fitDesignResolution: CC_EDITOR && function () {
    var designSize = cc.engine.getDesignResolutionSize();
    this.node.setPosition(designSize.width * 0.5, designSize.height * 0.5);
    this.node.setContentSize(designSize);
  },
  __preload: function __preload() {
    if (CC_DEV) {
      var Flags = cc.Object.Flags;
      this._objFlags |= Flags.IsPositionLocked | Flags.IsAnchorLocked | Flags.IsSizeLocked;
    }

    if (Canvas.instance) {
      return cc.errorID(6700, this.node.name, Canvas.instance.node.name);
    }

    Canvas.instance = this;

    if (CC_EDITOR) {
      cc.director.on(cc.Director.EVENT_AFTER_UPDATE, this._fitDesignResolution, this);
      cc.engine.on('design-resolution-changed', this._fitDesignResolution, this);
    }

    this.applySettings();
    CC_EDITOR && this._fitDesignResolution(); // Camera could be removed in canvas render mode

    var cameraNode = cc.find('Main Camera', this.node);

    if (!cameraNode) {
      cameraNode = new cc.Node('Main Camera');
      cameraNode.parent = this.node;
      cameraNode.setSiblingIndex(0);
    }

    var camera = cameraNode.getComponent(Camera);

    if (!camera) {
      camera = cameraNode.addComponent(Camera);
      var ClearFlags = Camera.ClearFlags;
      camera.clearFlags = ClearFlags.COLOR | ClearFlags.DEPTH | ClearFlags.STENCIL;
      camera.depth = -1;
    }

    Camera.main = camera;
  },
  onDestroy: function onDestroy() {
    if (CC_EDITOR) {
      cc.director.off(cc.Director.EVENT_AFTER_UPDATE, this._fitDesignResolution, this);
      cc.engine.off('design-resolution-changed', this._fitDesignResolution, this);
    }

    if (Canvas.instance === this) {
      Canvas.instance = null;
    }
  },
  applySettings: function applySettings() {
    var ResolutionPolicy = cc.ResolutionPolicy;
    var policy;

    if (this.fitHeight && this.fitWidth) {
      policy = ResolutionPolicy.SHOW_ALL;
    } else if (!this.fitHeight && !this.fitWidth) {
      policy = ResolutionPolicy.NO_BORDER;
    } else if (this.fitWidth) {
      policy = ResolutionPolicy.FIXED_WIDTH;
    } else {
      // fitHeight
      policy = ResolutionPolicy.FIXED_HEIGHT;
    }

    var designRes = this._designResolution;

    if (CC_EDITOR) {
      cc.engine.setDesignResolutionSize(designRes.width, designRes.height);
    } else {
      cc.view.setDesignResolutionSize(designRes.width, designRes.height, policy);
    }
  }
});
cc.Canvas = module.exports = Canvas;
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNDQ2FudmFzLmpzIl0sIm5hbWVzIjpbIkNhbWVyYSIsInJlcXVpcmUiLCJDb21wb25lbnQiLCJhZGRXaWRnZXRDb21wb25lbnQiLCJjYW52YXMiLCJ3aWRnZXQiLCJub2RlIiwiZ2V0Q29tcG9uZW50IiwiY2MiLCJXaWRnZXQiLCJhZGRDb21wb25lbnQiLCJpc0FsaWduVG9wIiwiaXNBbGlnbkJvdHRvbSIsImlzQWxpZ25MZWZ0IiwiaXNBbGlnblJpZ2h0IiwiQ2FudmFzIiwiQ2xhc3MiLCJuYW1lIiwiZWRpdG9yIiwiQ0NfRURJVE9SIiwibWVudSIsImhlbHAiLCJleGVjdXRlSW5FZGl0TW9kZSIsImRpc2FsbG93TXVsdGlwbGUiLCJyZXNldEluRWRpdG9yIiwiX1NjZW5lIiwiX2FwcGx5Q2FudmFzUHJlZmVyZW5jZXMiLCJzdGF0aWNzIiwiaW5zdGFuY2UiLCJwcm9wZXJ0aWVzIiwiX2Rlc2lnblJlc29sdXRpb24iLCJzaXplIiwiZGVzaWduUmVzb2x1dGlvbiIsImdldCIsInNldCIsInZhbHVlIiwid2lkdGgiLCJoZWlnaHQiLCJhcHBseVNldHRpbmdzIiwiX2ZpdERlc2lnblJlc29sdXRpb24iLCJ0b29sdGlwIiwiQ0NfREVWIiwiX2ZpdFdpZHRoIiwiX2ZpdEhlaWdodCIsImZpdEhlaWdodCIsImZpdFdpZHRoIiwiZGVzaWduU2l6ZSIsImVuZ2luZSIsImdldERlc2lnblJlc29sdXRpb25TaXplIiwic2V0UG9zaXRpb24iLCJzZXRDb250ZW50U2l6ZSIsIl9fcHJlbG9hZCIsIkZsYWdzIiwiT2JqZWN0IiwiX29iakZsYWdzIiwiSXNQb3NpdGlvbkxvY2tlZCIsIklzQW5jaG9yTG9ja2VkIiwiSXNTaXplTG9ja2VkIiwiZXJyb3JJRCIsImRpcmVjdG9yIiwib24iLCJEaXJlY3RvciIsIkVWRU5UX0FGVEVSX1VQREFURSIsImNhbWVyYU5vZGUiLCJmaW5kIiwiTm9kZSIsInBhcmVudCIsInNldFNpYmxpbmdJbmRleCIsImNhbWVyYSIsIkNsZWFyRmxhZ3MiLCJjbGVhckZsYWdzIiwiQ09MT1IiLCJERVBUSCIsIlNURU5DSUwiLCJkZXB0aCIsIm1haW4iLCJvbkRlc3Ryb3kiLCJvZmYiLCJSZXNvbHV0aW9uUG9saWN5IiwicG9saWN5IiwiU0hPV19BTEwiLCJOT19CT1JERVIiLCJGSVhFRF9XSURUSCIsIkZJWEVEX0hFSUdIVCIsImRlc2lnblJlcyIsInNldERlc2lnblJlc29sdXRpb25TaXplIiwidmlldyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTBCQSxJQUFJQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxvQkFBRCxDQUFwQjs7QUFDQSxJQUFJQyxTQUFTLEdBQUdELE9BQU8sQ0FBQyxlQUFELENBQXZCLEVBRUE7OztBQUNBLFNBQVNFLGtCQUFULENBQTZCQyxNQUE3QixFQUFxQztBQUNqQyxNQUFJQyxNQUFNLEdBQUdELE1BQU0sQ0FBQ0UsSUFBUCxDQUFZQyxZQUFaLENBQXlCQyxFQUFFLENBQUNDLE1BQTVCLENBQWI7O0FBQ0EsTUFBSSxDQUFDSixNQUFMLEVBQWE7QUFDVEEsSUFBQUEsTUFBTSxHQUFHRCxNQUFNLENBQUNFLElBQVAsQ0FBWUksWUFBWixDQUF5QkYsRUFBRSxDQUFDQyxNQUE1QixDQUFUO0FBQ0g7O0FBQ0RKLEVBQUFBLE1BQU0sQ0FBQ00sVUFBUCxHQUFvQixJQUFwQjtBQUNBTixFQUFBQSxNQUFNLENBQUNPLGFBQVAsR0FBdUIsSUFBdkI7QUFDQVAsRUFBQUEsTUFBTSxDQUFDUSxXQUFQLEdBQXFCLElBQXJCO0FBQ0FSLEVBQUFBLE1BQU0sQ0FBQ1MsWUFBUCxHQUFzQixJQUF0QjtBQUNIO0FBRUQ7Ozs7Ozs7OztBQU9BLElBQUlDLE1BQU0sR0FBR1AsRUFBRSxDQUFDUSxLQUFILENBQVM7QUFDbEJDLEVBQUFBLElBQUksRUFBRSxXQURZO0FBRWxCLGFBQVNmLFNBRlM7QUFJbEJnQixFQUFBQSxNQUFNLEVBQUVDLFNBQVMsSUFBSTtB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LFFBQTdCLEVBQXVDO0FBQ3hDa0MsTUFBQUEsTUFBTSxHQUFHRCxnQkFBZ0IsQ0FBQ0csU0FBMUI7QUFDSCxLQUZJLE1BR0EsSUFBSSxLQUFLcEMsUUFBVCxFQUFtQjtBQUNwQmtDLE1BQUFBLE1BQU0sR0FBR0QsZ0JBQWdCLENBQUNJLFdBQTFCO0FBQ0gsS0FGSSxNQUdBO0FBQU87QUFDUkgsTUFBQUEsTUFBTSxHQUFHRCxnQkFBZ0IsQ0FBQ0ssWUFBMUI7QUFDSDs7QUFFRCxRQUFJQyxTQUFTLEdBQUcsS0FBS3RELGlCQUFyQjs7QUFDQSxRQUFJWCxTQUFKLEVBQWU7QUFDWFgsTUFBQUEsRUFBRSxDQUFDdUMsTUFBSCxDQUFVc0MsdUJBQVYsQ0FBa0NELFNBQVMsQ0FBQ2hELEtBQTVDLEVBQW1EZ0QsU0FBUyxDQUFDL0MsTUFBN0Q7QUFDSCxLQUZELE1BR0s7QUFDRDdCLE1BQUFBLEVBQUUsQ0FBQzhFLElBQUgsQ0FBUUQsdUJBQVIsQ0FBZ0NELFNBQVMsQ0FBQ2hELEtBQTFDLEVBQWlEZ0QsU0FBUyxDQUFDL0MsTUFBM0QsRUFBbUUwQyxNQUFuRTtBQUNIO0FBQ0o7QUF6S2lCLENBQVQsQ0FBYjtBQTZLQXZFLEVBQUUsQ0FBQ08sTUFBSCxHQUFZd0UsTUFBTSxDQUFDQyxPQUFQLEdBQWlCekUsTUFBN0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIENvcHlyaWdodCAoYykgMjAxMy0yMDE2IENodWtvbmcgVGVjaG5vbG9naWVzIEluYy5cbiBDb3B5cmlnaHQgKGMpIDIwMTctMjAxOCBYaWFtZW4gWWFqaSBTb2Z0d2FyZSBDby4sIEx0ZC5cblxuIGh0dHBzOi8vd3d3LmNvY29zLmNvbS9cblxuIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGVuZ2luZSBzb3VyY2UgY29kZSAodGhlIFwiU29mdHdhcmVcIiksIGEgbGltaXRlZCxcbiAgd29ybGR3aWRlLCByb3lhbHR5LWZyZWUsIG5vbi1hc3NpZ25hYmxlLCByZXZvY2FibGUgYW5kIG5vbi1leGNsdXNpdmUgbGljZW5zZVxuIHRvIHVzZSBDb2NvcyBDcmVhdG9yIHNvbGVseSB0byBkZXZlbG9wIGdhbWVzIG9uIHlvdXIgdGFyZ2V0IHBsYXRmb3Jtcy4gWW91IHNoYWxsXG4gIG5vdCB1c2UgQ29jb3MgQ3JlYXRvciBzb2Z0d2FyZSBmb3IgZGV2ZWxvcGluZyBvdGhlciBzb2Z0d2FyZSBvciB0b29scyB0aGF0J3NcbiAgdXNlZCBmb3IgZGV2ZWxvcGluZyBnYW1lcy4gWW91IGFyZSBub3QgZ3JhbnRlZCB0byBwdWJsaXNoLCBkaXN0cmlidXRlLFxuICBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgQ29jb3MgQ3JlYXRvci5cblxuIFRoZSBzb2Z0d2FyZSBvciB0b29scyBpbiB0aGlzIExpY2Vuc2UgQWdyZWVtZW50IGFyZSBsaWNlbnNlZCwgbm90IHNvbGQuXG4gWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuIHJlc2VydmVzIGFsbCByaWdodHMgbm90IGV4cHJlc3NseSBncmFudGVkIHRvIHlvdS5cblxuIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gVEhFIFNPRlRXQVJFLlxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbnZhciBDYW1lcmEgPSByZXF1aXJlKCcuLi9jYW1lcmEvQ0NDYW1lcmEnKTtcbnZhciBDb21wb25lbnQgPSByZXF1aXJlKCcuL0NDQ29tcG9uZW50Jyk7XG5cbi8vIFNjcmVlbiBhZGFwdGF0aW9uIHN0cmF0ZWd5IGZvciBDYW52YXMgKyBXaWRnZXRcbmZ1bmN0aW9uIGFkZFdpZGdldENvbXBvbmVudCAoY2FudmFzKSB7XG4gICAgbGV0IHdpZGdldCA9IGNhbnZhcy5ub2RlLmdldENvbXBvbmVudChjYy5XaWRnZXQpO1xuICAgIGlmICghd2lkZ2V0KSB7XG4gICAgICAgIHdpZGdldCA9IGNhbnZhcy5ub2RlLmFkZENvbXBvbmVudChjYy5XaWRnZXQpO1xuICAgIH1cbiAgICB3aWRnZXQuaXNBbGlnblRvcCA9IHRydWU7XG4gICAgd2lkZ2V0LmlzQWxpZ25Cb3R0b20gPSB0cnVlO1xuICAgIHdpZGdldC5pc0FsaWduTGVmdCA9IHRydWU7XG4gICAgd2lkZ2V0LmlzQWxpZ25SaWdodCA9IHRydWU7XG59XG5cbi8qKlxuICogISN6aDog5L2c5Li6IFVJIOagueiKgueCue+8jOS4uuaJgOacieWtkOiKgueCueaPkOS+m+inhueql+Wbm+i+ueeahOS9jee9ruS/oeaBr+S7peS+m+Wvuem9kO+8jOWPpuWkluaPkOS+m+Wxj+W5lemAgumFjeetlueVpeaOpeWPo++8jOaWueS+v+S7jue8lui+keWZqOiuvue9ruOAglxuICog5rOo77ya55Sx5LqO5pys6IqC54K555qE5bC65a+45Lya6Lef6ZqP5bGP5bmV5ouJ5Ly477yM5omA5LulIGFuY2hvclBvaW50IOWPquaUr+aMgSAoMC41LCAwLjUp77yM5ZCm5YiZ6YCC6YWN5LiN5ZCM5bGP5bmV5pe25Z2Q5qCH5Lya5pyJ5YGP5beu44CCXG4gKlxuICogQGNsYXNzIENhbnZhc1xuICogQGV4dGVuZHMgQ29tcG9uZW50XG4gKi9cbnZhciBDYW52YXMgPSBjYy5DbGFzcyh7XG4gICAgbmFtZTogJ2NjLkNhbnZhcycsXG4gICAgZXh0ZW5kczogQ29tcG9uZW50LFxuXG4gICAgZWRpdG9yOiBDQ19FRElUT1IgJiYge1xuICAgICAgICBtZW51OiAnaTE4bjpNQUlOX01FTlUuY29tcG9uZW50LnVpL0NhbnZhcycsXG4gICAgICAgIGhlbHA6ICdpMThuOkNPTVBPTkVOVC5oZWxwX3VybC5jYW52YXMnLFxuICAgICAgICBleGVjdXRlSW5FZGl0TW9kZTogdHJ1ZSxcbiAgICAgICAgZGlzYWxsb3dNdWx0aXBsZTogdHJ1ZSxcbiAgICB9LFxuXG4gICAgcmVzZXRJbkVkaXRvcjogQ0NfRURJVE9SICYmIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX1NjZW5lLl9hcHBseUNhbnZhc1ByZWZlcmVuY2VzKHRoaXMpO1xuICAgICAgICBhZGRXaWRnZXRDb21wb25lbnQodGhpcyk7XG4gICAgfSxcblxuICAgIHN0YXRpY3M6IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqICEjZW4gQ3VycmVudCBhY3RpdmUgY2FudmFzLCB0aGUgc2NlbmUgc2hvdWxkIG9ubHkgaGF2ZSBvbmUgYWN0aXZlIGNhbnZhcyBhdCB0aGUgc2FtZSB0aW1lLlxuICAgICAgICAgKiAhI3poIOW9k+WJjea/gOa0u+eahOeUu+W4g+e7hOS7tu+8jOWcuuaZr+WQjOS4gOaXtumXtOWPquiDveacieS4gOS4qua/gOa0u+eahOeUu+W4g+OAglxuICAgICAgICAgKiBAcHJvcGVydHkge0NhbnZhc30gaW5zdGFuY2VcbiAgICAgICAgICogQHN0YXRpY1xuICAgICAgICAgKi9cbiAgICAgICAgaW5zdGFuY2U6IG51bGxcbiAgICB9LFxuXG4gICAgcHJvcGVydGllczoge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiAhI2VuIFRoZSBkZXNpZ2luIHJlc29sdXRpb24gZm9yIGN1cnJlbnQgc2NlbmUuXG4gICAgICAgICAqICEjemgg5b2T5YmN5Zy65pmv6K6+6K6h5YiG6L6o546H44CCXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7U2l6ZX0gZGVzaWduUmVzb2x1dGlvblxuICAgICAgICAgKiBAZGVmYXVsdCBuZXcgY2MuU2l6ZSg5NjAsIDY0MClcbiAgICAgICAgICovXG4gICAgICAgIF9kZXNpZ25SZXNvbHV0aW9uOiBjYy5zaXplKDk2MCwgNjQwKSxcbiAgICAgICAgZGVzaWduUmVzb2x1dGlvbjoge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNjLnNpemUodGhpcy5fZGVzaWduUmVzb2x1dGlvbik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZXNpZ25SZXNvbHV0aW9uLndpZHRoID0gdmFsdWUud2lkdGg7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVzaWduUmVzb2x1dGlvbi5oZWlnaHQgPSB2YWx1ZS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgQ0NfRURJVE9SICYmIHRoaXMuX2ZpdERlc2lnblJlc29sdXRpb24oKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0b29sdGlwOiBDQ19ERVYgJiYgJ2kxOG46Q09NUE9ORU5ULmNhbnZhcy5kZXNpZ25fcmVzb2x1dGlvbidcbiAgICAgICAgfSxcblxuICAgICAgICBfZml0V2lkdGg6IGZhbHNlLFxuICAgICAgICBfZml0SGVpZ2h0OiB0cnVlLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiAhI2VuIFRPRE9cbiAgICAgICAgICogISN6aDog5piv5ZCm5LyY5YWI5bCG6K6+6K6h5YiG6L6o546H6auY5bqm5pKR5ruh6KeG5Zu+6auY5bqm44CCXG4gICAgICAgICAqIEBwcm9wZXJ0eSB7Qm9vbGVhbn0gZml0SGVpZ2h0XG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICBmaXRIZWlnaHQ6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9maXRIZWlnaHQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZml0SGVpZ2h0ICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9maXRIZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvb2x0aXA6IENDX0RFViAmJiAnaTE4bjpDT01QT05FTlQuY2FudmFzLmZpdF9oZWlnaHQnXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqICEjZW4gVE9ET1xuICAgICAgICAgKiAhI3poOiDmmK/lkKbkvJjlhYjlsIborr7orqHliIbovqjnjoflrr3luqbmkpHmu6Hop4blm77lrr3luqbjgIJcbiAgICAgICAgICogQHByb3BlcnR5IHtCb29sZWFufSBmaXRXaWR0aFxuICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgKi9cbiAgICAgICAgZml0V2lkdGg6IHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9maXRXaWR0aDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9maXRXaWR0aCAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZml0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvb2x0aXA6IENDX0RFViAmJiAnaTE4bjpDT01QT05FTlQuY2FudmFzLmZpdF93aWR0aCdcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfZml0RGVzaWduUmVzb2x1dGlvbjogQ0NfRURJVE9SICYmIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRlc2lnblNpemUgPSBjYy5lbmdpbmUuZ2V0RGVzaWduUmVzb2x1dGlvblNpemUoKTtcbiAgICAgICAgdGhpcy5ub2RlLnNldFBvc2l0aW9uKGRlc2lnblNpemUud2lkdGggKiAwLjUsIGRlc2lnblNpemUuaGVpZ2h0ICogMC41KTtcbiAgICAgICAgdGhpcy5ub2RlLnNldENvbnRlbnRTaXplKGRlc2lnblNpemUpO1xuICAgIH0sXG5cbiAgICBfX3ByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKENDX0RFVikge1xuICAgICAgICAgICAgdmFyIEZsYWdzID0gY2MuT2JqZWN0LkZsYWdzO1xuICAgICAgICAgICAgdGhpcy5fb2JqRmxhZ3MgfD0gKEZsYWdzLklzUG9zaXRpb25Mb2NrZWQgfCBGbGFncy5Jc0FuY2hvckxvY2tlZCB8IEZsYWdzLklzU2l6ZUxvY2tlZCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoQ2FudmFzLmluc3RhbmNlKSB7XG4gICAgICAgICAgICByZXR1cm4gY2MuZXJyb3JJRCg2NzAwLFxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5uYW1lLCBDYW52YXMuaW5zdGFuY2Uubm9kZS5uYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBDYW52YXMuaW5zdGFuY2UgPSB0aGlzO1xuXG4gICAgICAgIGlmIChDQ19FRElUT1IpIHtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLm9uKGNjLkRpcmVjdG9yLkVWRU5UX0FGVEVSX1VQREFURSwgdGhpcy5fZml0RGVzaWduUmVzb2x1dGlvbiwgdGhpcyk7XG4gICAgICAgICAgICBjYy5lbmdpbmUub24oJ2Rlc2lnbi1yZXNvbHV0aW9uLWNoYW5nZWQnLCB0aGlzLl9maXREZXNpZ25SZXNvbHV0aW9uLCB0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYXBwbHlTZXR0aW5ncygpO1xuICAgICAgICBDQ19FRElUT1IgJiYgdGhpcy5fZml0RGVzaWduUmVzb2x1dGlvbigpO1xuXG4gICAgICAgIC8vIENhbWVyYSBjb3VsZCBiZSByZW1vdmVkIGluIGNhbnZhcyByZW5kZXIgbW9kZVxuICAgICAgICBsZXQgY2FtZXJhTm9kZSA9IGNjLmZpbmQoJ01haW4gQ2FtZXJhJywgdGhpcy5ub2RlKTtcbiAgICAgICAgaWYgKCFjYW1lcmFOb2RlKSB7XG4gICAgICAgICAgICBjYW1lcmFOb2RlID0gbmV3IGNjLk5vZGUoJ01haW4gQ2FtZXJhJyk7XG4gICAgICAgICAgICBjYW1lcmFOb2RlLnBhcmVudCA9IHRoaXMubm9kZTtcbiAgICAgICAgICAgIGNhbWVyYU5vZGUuc2V0U2libGluZ0luZGV4KDApO1xuICAgICAgICB9XG4gICAgICAgIGxldCBjYW1lcmEgPSBjYW1lcmFOb2RlLmdldENvbXBvbmVudChDYW1lcmEpO1xuICAgICAgICBpZiAoIWNhbWVyYSkge1xuICAgICAgICAgICAgY2FtZXJhID0gY2FtZXJhTm9kZS5hZGRDb21wb25lbnQoQ2FtZXJhKTtcblxuICAgICAgICAgICAgbGV0IENsZWFyRmxhZ3MgPSBDYW1lcmEuQ2xlYXJGbGFncztcbiAgICAgICAgICAgIGNhbWVyYS5jbGVhckZsYWdzID0gQ2xlYXJGbGFncy5DT0xPUiB8IENsZWFyRmxhZ3MuREVQVEggfCBDbGVhckZsYWdzLlNURU5DSUw7XG4gICAgICAgICAgICBjYW1lcmEuZGVwdGggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBDYW1lcmEubWFpbiA9IGNhbWVyYTtcbiAgICB9LFxuXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChDQ19FRElUT1IpIHtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLm9mZihjYy5EaXJlY3Rvci5FVkVOVF9BRlRFUl9VUERBVEUsIHRoaXMuX2ZpdERlc2lnblJlc29sdXRpb24sIHRoaXMpO1xuICAgICAgICAgICAgY2MuZW5naW5lLm9mZignZGVzaWduLXJlc29sdXRpb24tY2hhbmdlZCcsIHRoaXMuX2ZpdERlc2lnblJlc29sdXRpb24sIHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKENhbnZhcy5pbnN0YW5jZSA9PT0gdGhpcykge1xuICAgICAgICAgICAgQ2FudmFzLmluc3RhbmNlID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBhcHBseVNldHRpbmdzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBSZXNvbHV0aW9uUG9saWN5ID0gY2MuUmVzb2x1dGlvblBvbGljeTtcbiAgICAgICAgdmFyIHBvbGljeTtcblxuICAgICAgICBpZiAodGhpcy5maXRIZWlnaHQgJiYgdGhpcy5maXRXaWR0aCkge1xuICAgICAgICAgICAgcG9saWN5ID0gUmVzb2x1dGlvblBvbGljeS5TSE9XX0FMTDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghdGhpcy5maXRIZWlnaHQgJiYgIXRoaXMuZml0V2lkdGgpIHtcbiAgICAgICAgICAgIHBvbGljeSA9IFJlc29sdXRpb25Qb2xpY3kuTk9fQk9SREVSO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuZml0V2lkdGgpIHtcbiAgICAgICAgICAgIHBvbGljeSA9IFJlc29sdXRpb25Qb2xpY3kuRklYRURfV0lEVEg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7ICAgICAgLy8gZml0SGVpZ2h0XG4gICAgICAgICAgICBwb2xpY3kgPSBSZXNvbHV0aW9uUG9saWN5LkZJWEVEX0hFSUdIVDtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBkZXNpZ25SZXMgPSB0aGlzLl9kZXNpZ25SZXNvbHV0aW9uO1xuICAgICAgICBpZiAoQ0NfRURJVE9SKSB7XG4gICAgICAgICAgICBjYy5lbmdpbmUuc2V0RGVzaWduUmVzb2x1dGlvblNpemUoZGVzaWduUmVzLndpZHRoLCBkZXNpZ25SZXMuaGVpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNjLnZpZXcuc2V0RGVzaWduUmVzb2x1dGlvblNpemUoZGVzaWduUmVzLndpZHRoLCBkZXNpZ25SZXMuaGVpZ2h0LCBwb2xpY3kpO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5cblxuY2MuQ2FudmFzID0gbW9kdWxlLmV4cG9ydHMgPSBDYW52YXM7XG4iXX0=