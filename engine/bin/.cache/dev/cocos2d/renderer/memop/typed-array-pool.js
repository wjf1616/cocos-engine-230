
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/renderer/memop/typed-array-pool.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

exports.__esModule = true;
exports["default"] = void 0;

var _bufferPools = Array(8);

for (var i = 0; i < 8; ++i) {
  _bufferPools[i] = [];
}

function _nextPow16(v) {
  for (var _i = 16; _i <= 1 << 28; _i *= 16) {
    if (v <= _i) {
      return _i;
    }
  }

  return 0;
}

function _log2(v) {
  var r, shift;
  r = (v > 0xFFFF) << 4;
  v >>>= r;
  shift = (v > 0xFF) << 3;
  v >>>= shift;
  r |= shift;
  shift = (v > 0xF) << 2;
  v >>>= shift;
  r |= shift;
  shift = (v > 0x3) << 1;
  v >>>= shift;
  r |= shift;
  return r | v >> 1;
}

function _alloc(n) {
  var sz = _nextPow16(n);

  var bin = _bufferPools[_log2(sz) >> 2];

  if (bin.length > 0) {
    return bin.pop();
  }

  return new ArrayBuffer(sz);
}

function _free(buf) {
  _bufferPools[_log2(buf.byteLength) >> 2].push(buf);
}

var _default = {
  alloc_int8: function alloc_int8(n) {
    var result = new Int8Array(_alloc(n), 0, n);

    if (result.length !== n) {
      return result.subarray(0, n);
    }

    return result;
  },
  alloc_uint8: function alloc_uint8(n) {
    var result = new Uint8Array(_alloc(n), 0, n);

    if (result.length !== n) {
      return result.subarray(0, n);
    }

    return result;
  },
  alloc_int16: function alloc_int16(n) {
    var result = new Int16Array(_alloc(2 * n), 0, n);

    if (result.length !== n) {
      return result.subarray(0, n);
    }

    return result;
  },
  alloc_uint16: function alloc_uint16(n) {
    var result = new Uint16Array(_alloc(2 * n), 0, n);

    if (result.length !== n) {
      return result.subarray(0, n);
    }

    return result;
  },
  alloc_int32: function alloc_int32(n) {
    var result = new Int32Array(_alloc(4 * n), 0, n);

    if (result.length !== n) {
      return result.subarray(0, n);
    }

    return result;
  },
  alloc_uint32: function alloc_uint32(n) {
    var result = new Uint32Array(_alloc(4 * n), 0, n);

    if (result.length !== n) {
      return result.subarray(0, n);
    }

    return result;
  },
  alloc_float32: function alloc_float32(n) {
    var result = new Float32Array(_alloc(4 * n), 0, n);

    if (result.length !== n) {
      return result.subarray(0, n);
    }

    return result;
  },
  alloc_float64: function alloc_float64(n) {
    var result = new Float64Array(_alloc(8 * n), 0, n);

    if (result.length !== n) {
      return result.subarray(0, n);
    }

    return result;
  },
  alloc_dataview: function alloc_dataview(n) {
    var result = new DataView(_alloc(n), 0, n);

    if (result.length !== n) {
      return result.subarray(0, n);
    }

    return result;
  },
  free: function free(array) {
    _free(array.buffer);
  },
  reset: function reset() {
    var _bufferPools = Array(8);

    for (var _i2 = 0; _i2 < 8; ++_i2) {
      _bufferPools[_i2] = [];
    }
  }
};
exports["default"] = _default;
module.exports = exports["default"];
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInR5cGVkLWFycmF5LXBvb2wuanMiXSwibmFtZXMiOlsiX2J1ZmZlclBvb2xzIiwiQXJyYXkiLCJpIiwiX25leHRQb3cxNiIsInYiLCJfbG9nMiIsInIiLCJzaGlmdCIsIl9hbGxvYyIsIm4iLCJzeiIsImJpbiIsImxlbmd0aCIsInBvcCIsIkFycmF5QnVmZmVyIiwiX2ZyZWUiLCJidWYiLCJieXRlTGVuZ3RoIiwicHVzaCIsImFsbG9jX2ludDgiLCJyZXN1bHQiLCJJbnQ4QXJyYXkiLCJzdWJhcnJheSIsImFsbG9jX3VpbnQ4IiwiVWludDhBcnJheSIsImFsbG9jX2ludDE2IiwiSW50MTZBcnJheSIsImFsbG9jX3VpbnQxNiIsIlVpbnQxNkFycmF5IiwiYWxsb2NfaW50MzIiLCJJbnQzMkFycmF5IiwiYWxsb2NfdWludDMyIiwiVWludDMyQXJyYXkiLCJhbGxvY19mbG9hdDMyIiwiRmxvYXQzMkFycmF5IiwiYWxsb2NfZmxvYXQ2NCIsIkZsb2F0NjRBcnJheSIsImFsbG9jX2RhdGF2aWV3IiwiRGF0YVZpZXciLCJmcmVlIiwiYXJyYXkiLCJidWZmZXIiLCJyZXNldCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLFlBQVksR0FBR0MsS0FBSyxDQUFDLENBQUQsQ0FBeEI7O0FBQ0EsS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLENBQXBCLEVBQXVCLEVBQUVBLENBQXpCLEVBQTRCO0FBQzFCRixFQUFBQSxZQUFZLENBQUNFLENBQUQsQ0FBWixHQUFrQixFQUFsQjtBQUNEOztBQUVELFNBQVNDLFVBQVQsQ0FBb0JDLENBQXBCLEVBQXVCO0FBQ3JCLE9BQUssSUFBSUYsRUFBQyxHQUFHLEVBQWIsRUFBaUJBLEVBQUMsSUFBSyxLQUFLLEVBQTVCLEVBQWlDQSxFQUFDLElBQUksRUFBdEMsRUFBMEM7QUFDeEMsUUFBSUUsQ0FBQyxJQUFJRixFQUFULEVBQVk7QUFDVixhQUFPQSxFQUFQO0FBQ0Q7QUFDRjs7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R0FBQyxHQUFHLENBQWIsRUFBZ0JBLEdBQUMsR0FBRyxDQUFwQixFQUF1QixFQUFFQSxHQUF6QixFQUE0QjtBQUMxQkYsTUFBQUEsWUFBWSxDQUFDRSxHQUFELENBQVosR0FBa0IsRUFBbEI7QUFDRDtBQUNGO0FBM0ZZIiwic291cmNlc0NvbnRlbnQiOlsibGV0IF9idWZmZXJQb29scyA9IEFycmF5KDgpO1xuZm9yIChsZXQgaSA9IDA7IGkgPCA4OyArK2kpIHtcbiAgX2J1ZmZlclBvb2xzW2ldID0gW107XG59XG5cbmZ1bmN0aW9uIF9uZXh0UG93MTYodikge1xuICBmb3IgKGxldCBpID0gMTY7IGkgPD0gKDEgPDwgMjgpOyBpICo9IDE2KSB7XG4gICAgaWYgKHYgPD0gaSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICB9XG4gIHJldHVybiAwO1xufVxuXG5mdW5jdGlvbiBfbG9nMih2KSB7XG4gIGxldCByLCBzaGlmdDtcbiAgciA9ICh2ID4gMHhGRkZGKSA8PCA0OyB2ID4+Pj0gcjtcbiAgc2hpZnQgPSAodiA+IDB4RkYpIDw8IDM7IHYgPj4+PSBzaGlmdDsgciB8PSBzaGlmdDtcbiAgc2hpZnQgPSAodiA+IDB4RikgPDwgMjsgdiA+Pj49IHNoaWZ0OyByIHw9IHNoaWZ0O1xuICBzaGlmdCA9ICh2ID4gMHgzKSA8PCAxOyB2ID4+Pj0gc2hpZnQ7IHIgfD0gc2hpZnQ7XG4gIHJldHVybiByIHwgKHYgPj4gMSk7XG59XG5cbmZ1bmN0aW9uIF9hbGxvYyhuKSB7XG4gIGxldCBzeiA9IF9uZXh0UG93MTYobik7XG4gIGxldCBiaW4gPSBfYnVmZmVyUG9vbHNbX2xvZzIoc3opID4+IDJdO1xuICBpZiAoYmluLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gYmluLnBvcCgpO1xuICB9XG4gIHJldHVybiBuZXcgQXJyYXlCdWZmZXIoc3opO1xufVxuXG5mdW5jdGlvbiBfZnJlZShidWYpIHtcbiAgX2J1ZmZlclBvb2xzW19sb2cyKGJ1Zi5ieXRlTGVuZ3RoKSA+PiAyXS5wdXNoKGJ1Zik7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgYWxsb2NfaW50OChuKSB7XG4gICAgbGV0IHJlc3VsdCA9IG5ldyBJbnQ4QXJyYXkoX2FsbG9jKG4pLCAwLCBuKTtcbiAgICBpZiAocmVzdWx0Lmxlbmd0aCAhPT0gbikge1xuICAgICAgcmV0dXJuIHJlc3VsdC5zdWJhcnJheSgwLCBuKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuXG4gIGFsbG9jX3VpbnQ4KG4pIHtcbiAgICBsZXQgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoX2FsbG9jKG4pLCAwLCBuKTtcbiAgICBpZiAocmVzdWx0Lmxlbmd0aCAhPT0gbikge1xuICAgICAgcmV0dXJuIHJlc3VsdC5zdWJhcnJheSgwLCBuKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuXG4gIGFsbG9jX2ludDE2KG4pIHtcbiAgICBsZXQgcmVzdWx0ID0gbmV3IEludDE2QXJyYXkoX2FsbG9jKDIgKiBuKSwgMCwgbik7XG4gICAgaWYgKHJlc3VsdC5sZW5ndGggIT09IG4pIHtcbiAgICAgIHJldHVybiByZXN1bHQuc3ViYXJyYXkoMCwgbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcblxuICBhbGxvY191aW50MTYobikge1xuICAgIGxldCByZXN1bHQgPSBuZXcgVWludDE2QXJyYXkoX2FsbG9jKDIgKiBuKSwgMCwgbik7XG4gICAgaWYgKHJlc3VsdC5sZW5ndGggIT09IG4pIHtcbiAgICAgIHJldHVybiByZXN1bHQuc3ViYXJyYXkoMCwgbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcblxuICBhbGxvY19pbnQzMihuKSB7XG4gICAgbGV0IHJlc3VsdCA9IG5ldyBJbnQzMkFycmF5KF9hbGxvYyg0ICogbiksIDAsIG4pO1xuICAgIGlmIChyZXN1bHQubGVuZ3RoICE9PSBuKSB7XG4gICAgICByZXR1cm4gcmVzdWx0LnN1YmFycmF5KDAsIG4pO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG5cbiAgYWxsb2NfdWludDMyKG4pIHtcbiAgICBsZXQgcmVzdWx0ID0gbmV3IFVpbnQzMkFycmF5KF9hbGxvYyg0ICogbiksIDAsIG4pO1xuICAgIGlmIChyZXN1bHQubGVuZ3RoICE9PSBuKSB7XG4gICAgICByZXR1cm4gcmVzdWx0LnN1YmFycmF5KDAsIG4pO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG5cbiAgYWxsb2NfZmxvYXQzMihuKSB7XG4gICAgbGV0IHJlc3VsdCA9IG5ldyBGbG9hdDMyQXJyYXkoX2FsbG9jKDQgKiBuKSwgMCwgbik7XG4gICAgaWYgKHJlc3VsdC5sZW5ndGggIT09IG4pIHtcbiAgICAgIHJldHVybiByZXN1bHQuc3ViYXJyYXkoMCwgbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcblxuICBhbGxvY19mbG9hdDY0KG4pIHtcbiAgICBsZXQgcmVzdWx0ID0gbmV3IEZsb2F0NjRBcnJheShfYWxsb2MoOCAqIG4pLCAwLCBuKTtcbiAgICBpZiAocmVzdWx0Lmxlbmd0aCAhPT0gbikge1xuICAgICAgcmV0dXJuIHJlc3VsdC5zdWJhcnJheSgwLCBuKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuXG4gIGFsbG9jX2RhdGF2aWV3KG4pIHtcbiAgICBsZXQgcmVzdWx0ID0gbmV3IERhdGFWaWV3KF9hbGxvYyhuKSwgMCwgbik7XG4gICAgaWYgKHJlc3VsdC5sZW5ndGggIT09IG4pIHtcbiAgICAgIHJldHVybiByZXN1bHQuc3ViYXJyYXkoMCwgbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcblxuICBmcmVlKGFycmF5KSB7XG4gICAgX2ZyZWUoYXJyYXkuYnVmZmVyKTtcbiAgfSxcblxuICByZXNldCgpIHtcbiAgICBsZXQgX2J1ZmZlclBvb2xzID0gQXJyYXkoOCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyArK2kpIHtcbiAgICAgIF9idWZmZXJQb29sc1tpXSA9IFtdO1xuICAgIH1cbiAgfSxcbn07Il19